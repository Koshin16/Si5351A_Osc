# RP2040 USB Serial CLI（AE-Si5351A 専用, I2C=0x60 固定）

## 📘 概要
このプログラムは、**RP2040（例：Seeed XIAO RP2040）**上で動作する  
**Si5351A クロックジェネレータ（秋月 AE-Si5351A モジュール）制御用 USB シリアル CLI**です。  
USB 経由で PC からコマンドを入力し、I²C 経由で Si5351A の周波数設定や出力制御を行います。

---

## ⚙️ 主な機能

### 1. USB シリアル CLI 起動
- USB 接続を待機し、接続後にバナーを表示。
- 改行コードやローカルエコーの設定を案内。
- `help` または `h` コマンドで使い方を表示可能。

### 2. I²C バス初期化
- 配線：SDA=GPIO7(D5), SCL=GPIO6(D4)
- 通信速度：100 kHz（Si5351A は最大 400 kHz 対応）
- 起動時に `i2c_bus_clear()` 実行後、`i2c_init_config()` によりポート設定。

### 3. LED 点滅（動作インジケータ）
- `start_led_blinking(250)` により、LED が 250ms 周期で点滅。
- 動作中であることを視覚的に確認可能。

### 4. Si5351A 通信確認
- `ping_si5351()` によりアドレス 0x60 に対して ACK 応答を確認。
- 応答なし（NACK/Timeout）の場合は無限ループで停止。

### 5. I²C デバイススキャン
- `scan_strict()` で 0x03〜0x77 の範囲を厳密スキャン。
- 書き込み＋読み出しテストで接続デバイスを特定。

### 6. Si5351A 初期化と設定
- `si5351_cli_init()` により I²C ポートとデバイスアドレスを登録。
- `"init"` コマンドで PLLA を初期化。
- `"clk0=100"` により CLK0 を 100 MHz に設定。
- `"clk1=0"`, `"clk2=0"` により他出力を無効化。

### 7. USB CLI ループ
- ユーザ入力を非同期に受け取り、改行でコマンド実行。
- コマンド例：
  - `scan` → I²C デバイススキャン実行  
  - `ping` → Si5351A 応答確認  
  - その他：`si5351_cli_handle(cmd)` 経由で任意の Si5351A 制御

---

## 🧩 補助モジュール（外部ヘッダ）

| ヘッダ名 | 内容 |
|-----------|------|
| `I2C_comm.h` | I²C 初期化・読み書き・バスクリア関数群 |
| `led_blink.h` | LED 点滅制御（状態表示用） |
| `si5351_cli.h` | Si5351A 制御 CLI 関数群（init, clk0/1/2, oe など） |

---

## 💬 起動時メッセージ例


